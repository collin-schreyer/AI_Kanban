<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Projects Kanban Board</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-screen">
        <div class="login-container">
            <img src="logo.png" alt="Logo" class="login-logo">
            <h1>AI Projects Kanban</h1>
            <p>Sign in to continue</p>
            <form id="loginForm" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label>Username</label>
                    <input type="text" id="loginUsername" required autocomplete="username">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="loginPassword" required autocomplete="current-password">
                </div>
                <div id="loginError" class="login-error"></div>
                <button type="submit" class="btn btn-primary btn-full">Sign In</button>
            </form>
        </div>
    </div>

    <div class="app-container" id="appContainer" style="display: none;">
        <header class="header">
            <div class="header-title">
                <img src="logo.png" alt="Logo" class="header-logo">
                <h1>AI Projects Kanban</h1>
            </div>
            <div class="header-controls">
                <div class="user-info">
                    <span id="currentUserDisplay">Logged in as: </span>
                    <button class="btn btn-secondary" onclick="handleLogout()">Logout</button>
                </div>
                <button class="btn btn-primary" onclick="openAddProjectModal()">+ New Project</button>
                <button class="btn btn-exec" onclick="generateExecOverview()">üìä Carl's AI Overview</button>
            </div>
        </header>

        <!-- Tab Navigation -->
        <div class="tab-nav">
            <button class="tab-btn active" onclick="switchTab('board')">üìã Board</button>
            <button class="tab-btn" onclick="switchTab('analytics')">üìà Analytics</button>
            <button class="tab-btn" onclick="switchTab('research')">üß™ AI Research</button>
            <button class="tab-btn" onclick="switchTab('builder')">üîß Builder Mode</button>
            <button class="tab-btn" onclick="switchTab('dashboard')">üîç Timelines</button>
            <button class="tab-btn" onclick="switchTab('schedule')">üóìÔ∏è Collin's Schedule</button>
        </div>

        <!-- AI Insights Sidebar -->
        <button class="insights-toggle collapsed" id="insightsToggle" onclick="toggleInsightsSidebar()">üí°</button>
        <div class="insights-sidebar collapsed" id="insightsSidebar">
            <div class="insights-header">
                <h3>‚ú® AI Insights</h3>
                <button class="insights-refresh" onclick="refreshInsights()" title="Refresh">üîÑ</button>
            </div>
            <div class="insights-content" id="insightsContent">
                <div class="insights-loading">Loading insights...</div>
            </div>
        </div>

        <!-- Board Tab -->
        <div id="boardTab" class="tab-content active">
            <div class="filters">
                <select id="projectFilter" onchange="filterCards()">
                    <option value="">All Projects</option>
                </select>
                <select id="ownerFilter" onchange="filterCards()">
                    <option value="">All Owners</option>
                    <option value="Carl">Carl</option>
                    <option value="Ann">Ann</option>
                    <option value="Tom">Tom</option>
                    <option value="Collin">Collin</option>
                </select>
                <select id="priorityFilter" onchange="filterCards()">
                    <option value="">All Priorities</option>
                    <option value="high">High</option>
                    <option value="medium">Medium</option>
                    <option value="low">Low</option>
                </select>
                <button class="btn btn-secondary" onclick="exportData()">üì• Export</button>
            </div>

            <div class="kanban-board">
            <div class="kanban-column" data-status="todo">
                <div class="column-header">
                    <h2>üìã To Do</h2>
                    <span class="card-count" id="todo-count">0</span>
                </div>
                <div class="card-container" id="todo" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
            </div>
            <div class="kanban-column" data-status="inprogress">
                <div class="column-header">
                    <h2>üîÑ In Progress</h2>
                    <span class="card-count" id="inprogress-count">0</span>
                </div>
                <div class="card-container" id="inprogress" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
            </div>
            <div class="kanban-column" data-status="review">
                <div class="column-header">
                    <h2>üëÄ Review</h2>
                    <span class="card-count" id="review-count">0</span>
                </div>
                <div class="card-container" id="review" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
            </div>
            <div class="kanban-column" data-status="done">
                <div class="column-header">
                    <h2>‚úÖ Done</h2>
                    <span class="card-count" id="done-count">0</span>
                </div>
                <div class="card-container" id="done" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
            </div>
        </div>

        <div class="activity-panel">
                <h3>üìù Activity Log</h3>
                <div id="activityLog"></div>
            </div>
        </div>

        <!-- Analytics Tab -->
        <div id="analyticsTab" class="tab-content">
            <div class="analytics-container">
                <div class="analytics-header">
                    <h2>üìà Executive Analytics</h2>
                    <div class="analytics-controls">
                        <div class="analytics-filters">
                            <select id="analyticsOwnerFilter" onchange="updateAnalytics()">
                                <option value="">All Owners</option>
                                <option value="Carl">Carl</option>
                                <option value="Ann">Ann</option>
                                <option value="Tom">Tom</option>
                            </select>
                            <select id="analyticsPriorityFilter" onchange="updateAnalytics()">
                                <option value="">All Priorities</option>
                                <option value="high">High Priority</option>
                                <option value="medium">Medium Priority</option>
                                <option value="low">Low Priority</option>
                            </select>
                            <select id="analyticsTimeFilter" onchange="updateAnalytics()">
                                <option value="all">All Time</option>
                                <option value="week">This Week</option>
                                <option value="month">This Month</option>
                                <option value="quarter">This Quarter</option>
                            </select>
                        </div>
                        <div class="analytics-actions">
                            <button class="btn btn-secondary" onclick="exportAnalyticsPDF()">üìÑ Export PDF</button>
                            <button class="btn btn-secondary" onclick="exportAnalyticsExcel()">üìä Export Excel</button>
                        </div>
                    </div>
                </div>
                
                <!-- Portfolio Health Score -->
                <div class="health-score-section" id="healthScoreSection">
                    <!-- Health score will be rendered here -->
                </div>
                
                <!-- KPI Cards with Trends -->
                <div class="analytics-kpis" id="analyticsKpis">
                    <!-- KPI cards will be rendered here -->
                </div>
                
                <!-- Week Comparison -->
                <div class="comparison-section" id="comparisonSection">
                    <!-- Week comparison will be rendered here -->
                </div>
                
                <!-- At Risk Section -->
                <div class="at-risk-section" id="atRiskSection">
                    <!-- At risk items will be rendered here -->
                </div>
                
                <!-- AI Focus Areas -->
                <div class="focus-areas-section" id="focusAreasSection">
                    <!-- AI insights will be rendered here -->
                </div>
                
                <div class="analytics-charts">
                    <div class="analytics-chart-card">
                        <h3>Progress by Owner</h3>
                        <div class="chart-container" id="ownerChart"></div>
                    </div>
                    <div class="analytics-chart-card">
                        <h3>Task Status Distribution</h3>
                        <div class="chart-container" id="statusChart"></div>
                    </div>
                    <div class="analytics-chart-card">
                        <h3>Priority Breakdown</h3>
                        <div class="chart-container" id="priorityChart"></div>
                    </div>
                    <div class="analytics-chart-card full-width">
                        <h3>üìà Burndown Chart</h3>
                        <div class="chart-container" id="burndownChart"></div>
                    </div>
                    <div class="analytics-chart-card full-width">
                        <h3>‚ö° Velocity Trend</h3>
                        <div class="chart-container" id="velocityChart"></div>
                    </div>
                </div>
                
                <div class="analytics-table-section">
                    <h3>üìä Project Performance</h3>
                    <table class="analytics-table" id="analyticsTable">
                        <thead>
                            <tr>
                                <th>Project</th>
                                <th>Owner</th>
                                <th>Priority</th>
                                <th>Health</th>
                                <th>Progress</th>
                                <th>Tasks</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="analyticsTableBody">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- AI Research Tab -->
        <div id="researchTab" class="tab-content">
            <div class="research-container">
                <div class="research-header">
                    <div class="research-title-section">
                        <h2>üß™ B&A's AI Research</h2>
                        <p class="research-subtitle">R&D concepts, experiments, and proof-of-concepts by Collin</p>
                    </div>
                    <button class="btn btn-primary" onclick="openAddResearchModal()">+ New Concept</button>
                </div>
                <div class="research-grid" id="researchGrid">
                    <!-- Research posts will be rendered here -->
                </div>
            </div>
        </div>

        <!-- Builder Mode Tab -->
        <div id="builderTab" class="tab-content">
            <div class="builder-container">
                <div class="builder-header">
                    <div class="builder-title-section">
                        <h2>üîß Builder Mode</h2>
                        <p class="builder-subtitle">Tell the AI what you're working on and it will suggest board updates for your approval</p>
                    </div>
                </div>
                
                <div class="builder-main">
                    <div class="builder-input-section">
                        <div class="builder-context">
                            <h3>üìç Current Context</h3>
                            <div class="builder-selects">
                                <div class="form-group">
                                    <label>Working on Project</label>
                                    <select id="builderProject">
                                        <option value="">Select a project...</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Specific Task (optional)</label>
                                    <select id="builderTask">
                                        <option value="">Select a task...</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Mode Toggle -->
                        <div class="builder-mode-toggle">
                            <button class="mode-btn active" id="modeSimple" onclick="setBuilderMode('simple')">üí¨ Quick Update</button>
                            <button class="mode-btn" id="modeBulk" onclick="setBuilderMode('bulk')">üìã Bulk Import</button>
                        </div>
                        
                        <!-- Simple Update Mode -->
                        <div class="builder-update" id="simpleMode">
                            <h3>üí¨ What are you doing?</h3>
                            <textarea id="builderInput" rows="4" placeholder="Example: Just finished the API integration for the USCIS project. Moving on to testing now. Also completed the documentation for State Dept."></textarea>
                            <button class="btn btn-primary btn-full" onclick="analyzeBuilderUpdate()">ü§ñ Analyze & Suggest Changes</button>
                        </div>
                        
                        <!-- Bulk Import Mode -->
                        <div class="builder-bulk" id="bulkMode" style="display: none;">
                            <h3>üìã Paste Progress Report</h3>
                            <p class="bulk-hint">Paste a structured progress update, status table, or accomplishments list. The AI will parse it and create/update all tasks.</p>
                            <textarea id="bulderBulkInput" rows="12" placeholder="Paste your progress report here...

Example format:
üèõÔ∏è Drafting Engine
DONE - LCD Page View Preview: Pixel-perfect 8.5&quot; x 11&quot; simulation
DONE - Template Engine v1.0: Dynamic logic for Amendment generation
IN PROGRESS - Entity Database: Building the repository of recurring Clients

Or any structured format - the AI will figure it out!"></textarea>
                            <button class="btn btn-primary btn-full" onclick="analyzeBulkImport()">ü§ñ Parse & Generate Tasks</button>
                        </div>
                        
                        <div class="builder-quick-actions" id="quickActionsSection">
                            <h3>‚ö° Quick Updates</h3>
                            <div class="quick-action-buttons">
                                <button class="btn btn-secondary" onclick="quickBuilderAction('started')">Started working on this</button>
                                <button class="btn btn-secondary" onclick="quickBuilderAction('completed')">Just completed this task</button>
                                <button class="btn btn-secondary" onclick="quickBuilderAction('blocked')">I'm blocked on this</button>
                                <button class="btn btn-secondary" onclick="quickBuilderAction('review')">Ready for review</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="builder-suggestions-section">
                        <h3>üìã Suggested Changes</h3>
                        <p class="builder-suggestions-hint">AI will suggest card movements based on your update. Review and approve each change.</p>
                        <div id="builderSuggestions" class="builder-suggestions">
                            <div class="builder-empty">
                                <div class="builder-empty-icon">ü§ñ</div>
                                <p>Describe what you're working on and the AI will suggest board updates</p>
                            </div>
                        </div>
                        
                        <div id="builderActions" class="builder-action-buttons" style="display: none;">
                            <button class="btn btn-primary" onclick="approveAllChanges()">‚úÖ Approve All Changes</button>
                            <button class="btn btn-secondary" onclick="clearSuggestions()">‚ùå Clear All</button>
                        </div>
                    </div>
                </div>
                
                <div class="builder-history">
                    <h3>üìú Recent Updates</h3>
                    <div id="builderHistory" class="builder-history-list">
                        <!-- History will be rendered here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Timelines Tab (formerly Dashboard) -->
        <div id="dashboardTab" class="tab-content">
            <div class="dashboard-container">
                <div class="dashboard-header">
                    <h2>üîç Project Timelines</h2>
                    <p class="dashboard-subtitle">AI-generated journey analysis for each project</p>
                </div>
                <div class="dashboard-grid" id="dashboardGrid">
                    <div class="dashboard-loading">Loading projects...</div>
                </div>
            </div>
        </div>

        <!-- Collin's Schedule Tab -->
        <div id="scheduleTab" class="tab-content">
            <div class="schedule-container">
                <div class="schedule-header">
                    <h2>üóìÔ∏è Collin's Build Schedule</h2>
                    <p class="schedule-subtitle">AI-prioritized work queue based on project urgency, owner needs, and deadlines</p>
                    <div class="schedule-actions">
                        <button class="btn btn-primary" onclick="refreshSchedule()">üîÑ Refresh AI Analysis</button>
                        <button class="btn btn-secondary" onclick="generateReport('daily')">üìã Daily Report</button>
                        <button class="btn btn-secondary" onclick="generateReport('weekly')">üìä Weekly Report</button>
                    </div>
                </div>
                <div class="schedule-content" id="scheduleContent">
                    <div class="schedule-loading">Click "Refresh AI Analysis" to generate Collin's schedule</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Report Modal -->
    <div id="reportModal" class="modal">
        <div class="modal-content modal-report">
            <span class="close" onclick="closeModal('reportModal')">&times;</span>
            <div id="reportContent"></div>
            <div class="report-actions">
                <button class="btn btn-primary" onclick="copyReport()">üìã Copy to Clipboard</button>
                <button class="btn btn-secondary" onclick="downloadReport()">üì• Download</button>
            </div>
        </div>
    </div>

    <!-- Add/Edit Project Modal -->
    <div id="projectModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('projectModal')">&times;</span>
            <h2 id="modalTitle">Add New Project</h2>
            <form id="projectForm" onsubmit="saveProject(event)">
                <input type="hidden" id="projectId">
                <div class="form-group">
                    <label>Project Name</label>
                    <input type="text" id="projectName" required>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea id="projectDescription" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Owner</label>
                    <select id="projectOwner" required>
                        <option value="Carl">Carl</option>
                        <option value="Ann">Ann</option>
                        <option value="Tom">Tom</option>
                        <option value="Collin">Collin</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Priority</label>
                    <select id="projectPriority">
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                        <option value="low">Low</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Due Date</label>
                    <input type="date" id="projectDueDate">
                </div>
                <div class="form-group">
                    <label>Tags (comma separated)</label>
                    <input type="text" id="projectTags" placeholder="e.g., proposal, active, urgent">
                </div>
                <button type="submit" class="btn btn-primary">Save Project</button>
            </form>
        </div>
    </div>

    <!-- Card Detail Modal -->
    <div id="cardDetailModal" class="modal">
        <div class="modal-content modal-large">
            <span class="close" onclick="closeModal('cardDetailModal')">&times;</span>
            <div id="cardDetailContent"></div>
        </div>
    </div>

    <!-- Add Subtask Modal -->
    <div id="subtaskModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('subtaskModal')">&times;</span>
            <h2 id="subtaskModalTitle">Add Sub-Task</h2>
            <form id="subtaskForm" onsubmit="saveSubtask(event)">
                <input type="hidden" id="subtaskId">
                <input type="hidden" id="subtaskProjectId">
                <div class="form-group">
                    <label>Sub-Task Name</label>
                    <input type="text" id="subtaskName" required>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea id="subtaskDescription" rows="2"></textarea>
                </div>
                <div class="form-group">
                    <label>Assignee</label>
                    <select id="subtaskAssignee">
                        <option value="">Unassigned</option>
                        <option value="Collin">Collin</option>
                        <option value="Carl">Carl</option>
                        <option value="Ann">Ann</option>
                        <option value="Tom">Tom</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Due Date</label>
                    <input type="date" id="subtaskDueDate">
                </div>
                <button type="submit" class="btn btn-primary">Save Sub-Task</button>
            </form>
        </div>
    </div>

    <!-- Executive Overview Modal -->
    <div id="execModal" class="modal">
        <div class="modal-content modal-exec">
            <span class="close" onclick="closeModal('execModal')">&times;</span>
            <div id="execContent"></div>
            <div class="report-actions">
                <button class="btn btn-primary" onclick="copyExecReport()">üìã Copy to Clipboard</button>
                <button class="btn btn-secondary" onclick="downloadExecReport()">üì• Download PDF-Ready</button>
                <button class="btn btn-secondary" onclick="emailExecReport()">üìß Email to Jonathan</button>
            </div>
        </div>
    </div>

    <!-- Timeline Modal -->
    <div id="timelineModal" class="modal">
        <div class="modal-content modal-large">
            <span class="close" onclick="closeModal('timelineModal')">&times;</span>
            <div id="timelineContent"></div>
        </div>
    </div>

    <!-- Add/Edit Research Modal -->
    <div id="researchModal" class="modal">
        <div class="modal-content modal-large">
            <span class="close" onclick="closeModal('researchModal')">&times;</span>
            <h2 id="researchModalTitle">New AI Concept</h2>
            <form id="researchForm" onsubmit="saveResearch(event)">
                <input type="hidden" id="researchId">
                <div class="form-group">
                    <label>Concept Title</label>
                    <input type="text" id="researchTitle" required placeholder="e.g., Voice-to-SQL Query Engine">
                </div>
                <div class="form-group">
                    <label>Category</label>
                    <select id="researchCategory">
                        <option value="nlp">Natural Language Processing</option>
                        <option value="rag">RAG / Knowledge Systems</option>
                        <option value="agents">AI Agents</option>
                        <option value="voice">Voice / Speech</option>
                        <option value="vision">Computer Vision</option>
                        <option value="automation">Automation</option>
                        <option value="infrastructure">Infrastructure / DevOps</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Summary</label>
                    <textarea id="researchSummary" rows="2" placeholder="Brief one-liner about the concept"></textarea>
                </div>
                <div class="form-group">
                    <label>Description / Notes</label>
                    <textarea id="researchDescription" rows="6" placeholder="Detailed notes, findings, technical approach..."></textarea>
                </div>
                <div class="form-group">
                    <label>Loom Video URL (optional)</label>
                    <input type="url" id="researchLoomUrl" placeholder="https://www.loom.com/share/...">
                </div>
                <div class="form-group">
                    <label>Demo URL (optional)</label>
                    <input type="url" id="researchDemoUrl" placeholder="https://...">
                </div>
                <div class="form-group">
                    <label>GitHub Repo (optional)</label>
                    <input type="url" id="researchGithubUrl" placeholder="https://github.com/...">
                </div>
                <div class="form-group">
                    <label>Tags (comma separated)</label>
                    <input type="text" id="researchTags" placeholder="e.g., bedrock, lambda, poc">
                </div>
                <div class="form-group">
                    <label>Status</label>
                    <select id="researchStatus">
                        <option value="idea">üí° Idea</option>
                        <option value="exploring">üî¨ Exploring</option>
                        <option value="prototype">üõ†Ô∏è Prototype Built</option>
                        <option value="demo">üé¨ Demo Ready</option>
                        <option value="promoted">üöÄ Promoted to Project</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">Save Concept</button>
            </form>
        </div>
    </div>

    <!-- Research Detail Modal -->
    <div id="researchDetailModal" class="modal">
        <div class="modal-content modal-large">
            <span class="close" onclick="closeModal('researchDetailModal')">&times;</span>
            <div id="researchDetailContent"></div>
        </div>
    </div>

    <!-- AI Assistant -->
    <div id="aiAssistant" class="ai-assistant">
        <div class="ai-header">
            <span onclick="toggleAiChat()"><img src="logo.png" alt="" class="ai-logo"> AI Assistant</span>
            <div class="ai-header-controls">
                <button class="ai-expand-btn" onclick="toggleAiExpand()" title="Expand">‚õ∂</button>
                <span id="aiToggle" onclick="toggleAiChat()">‚ñº</span>
            </div>
        </div>
        <div class="ai-body collapsed" id="aiBody">
            <div class="ai-messages" id="aiMessages"></div>
            <div class="ai-examples" id="aiExamples">
                <div class="ai-examples-label">Try asking:</div>
                <button class="ai-example-btn" onclick="askExample(this)">What is Collin working on?</button>
                <button class="ai-example-btn" onclick="askExample(this)">What are Carl's projects?</button>
                <button class="ai-example-btn" onclick="askExample(this)">What's the overall progress?</button>
                <button class="ai-example-btn" onclick="askExample(this)">What was recently completed?</button>
            </div>
            <div class="ai-input-container">
                <input type="text" id="aiInput" placeholder="Ask about projects, progress, tasks..." onkeypress="handleAiKeypress(event)">
                <button class="btn btn-primary" onclick="sendAiMessage()">Send</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
